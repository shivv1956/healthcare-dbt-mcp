version: 2

models:
  - name: stg_claims_transactions
    description: "Staging table for claim transactions with validated UUIDs and deduplication."
    columns:
      - name: id
        description: "Unique identifier for the transaction"
        tests:
          - not_null
          - unique

      - name: claim_id
        description: "Claim identifier this transaction belongs to"
        tests:
          - not_null
          - relationships:
              arguments:
                to: ref('stg_claims')
                field: claim_id

      - name: patient_id
        description: "Unique identifier for the patient"
        tests:
          - not_null
          - relationships:
              arguments:
                to: ref('stg_patients')
                field: patient_id

      - name: provider_id
        description: "Unique identifier for the provider"
        tests:
          - not_null
          # - relationships:
          #     arguments:
          #       to: ref('stg_providers')
          #       field: id

      - name: type
        description: "Transaction type (CHARGE, PAYMENT, ADJUSTMENT, TRANSFERIN, TRANSFEROUT)"
        tests:
          - accepted_values:
              arguments:
                values: ['CHARGE','PAYMENT','ADJUSTMENT','TRANSFERIN','TRANSFEROUT']

      - name: transfer_type
        description: "Transfer type ('1','2','p')"
        tests:
          - accepted_values:
              arguments:
                values: ['1','2','p']
